Update
| where OSType!="Linux" and (Optional==false or Classification has "Critical" or Classification has "Security") and SourceComputerId in ((Heartbeat
| where OSType=~"Windows" and notempty(Computer)
| summarize arg_max(TimeGenerated, Solutions) by SourceComputerId
| where Solutions has "updates"
| distinct SourceComputerId))
| summarize hint.strategy=partitioned arg_max(TimeGenerated, *) by Computer, UpdateID
| where KBID in ("4580328", "4580330", "4577668", "4577671", "4579311", "4486676") and UpdateState == "Needed"
| order by KBID
| render table
